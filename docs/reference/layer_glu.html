<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="In such form introduced in Language modeling with gated convolutional networks
by Dauphin et al., when it was used in sequence processing tasks and compared with
gating mechanism used in LSTM layers. In the context of time series processing explicitly proposed in Temporal Fusion Transformer."><title>Gated Linear Unit — layer_glu • aion</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Gated Linear Unit — layer_glu"><meta property="og:description" content="In such form introduced in Language modeling with gated convolutional networks
by Dauphin et al., when it was used in sequence processing tasks and compared with
gating mechanism used in LSTM layers. In the context of time series processing explicitly proposed in Temporal Fusion Transformer."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><script defer data-domain="pkgdown.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-secondary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">aion</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Gated Linear Unit</h1>
      
      <div class="d-none name"><code>layer_glu.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>In such form introduced in <a href="https://arxiv.org/abs/1612.08083" class="external-link">Language modeling with gated convolutional networks</a>
by Dauphin et al., when it was used in sequence processing tasks and compared with
gating mechanism used in LSTM layers. In the context of time series processing explicitly proposed in <a href="https://arxiv.org/pdf/1912.09363.pdf" class="external-link">Temporal Fusion Transformer</a>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">layer_glu</span><span class="op">(</span><span class="va">object</span>, <span class="va">units</span>, activation <span class="op">=</span> <span class="cn">NULL</span>, return_gate <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>What to compose the new <code>Layer</code> instance with. Typically a
Sequential model or a Tensor (e.g., as returned by <code><a href="https://rdrr.io/pkg/keras/man/layer_input.html" class="external-link">layer_input()</a></code>).
The return value depends on <code>object</code>. If <code>object</code> is:</p><ul><li><p>missing or <code>NULL</code>, the <code>Layer</code> instance is returned.</p></li>
<li><p>a <code>Sequential</code> model, the model with an additional layer is returned.</p></li>
<li><p>a Tensor, the output tensor from <code>layer_instance(object)</code> is returned.</p></li>
</ul></dd>


<dt>units</dt>
<dd><p>Positive integer, dimensionality of the output space.</p></dd>


<dt>activation</dt>
<dd><p>Name of activation function to use. If you don't specify
anything, no activation is applied (ie. "linear" activation: a(x) = x).</p></dd>


<dt>return_gate</dt>
<dd><p>Logical - return gate values. Default: FALSE</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Tensor of shape (batch_size, ..., units). Optionally, it can also return a weights tensor
with identical shape.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Computed according to the equation:
$$GLU(\gamma) = \sigma(W\gamma + b) \odot (V\gamma + c)$$</p>
    </div>
    <div class="section level2">
    <h2 id="input-and-output-shapes">Input and Output Shapes<a class="anchor" aria-label="anchor" href="#input-and-output-shapes"></a></h2>
    



<p>Input shape: nD tensor with shape: <code>(batch_size, ..., input_dim)</code>. The most
common situation would be a 2D input with shape <code>(batch_size, input_dim)</code>.</p>
<p>Output shape: nD tensor with shape: <code>(batch_size, ..., units)</code>. For
instance, for a 2D input with shape <code>(batch_size, input_dim)</code>, the output
would have shape <code>(batch_size, unit)</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    
<ol><li><p>Dauphin, Yann N., et al. (2017). <a href="https://arxiv.org/abs/1612.08083" class="external-link">Language modeling with gated convolutional networks.</a>.
International conference on machine learning. PMLR</p></li>
<li><p>Lim, Bryan et al. (2019). <a href="https://arxiv.org/abs/1612.08083" class="external-link">Temporal Fusion Transformers for Interpretable Multi-horizon Time Series Forecasting</a>. arXiv</p></li>
<li><p><a href="https://github.com/jdb78/pytorch-forecasting/blob/268121aa9aa732558beefb6d9f95feff955ad08b/pytorch_forecasting/models/temporal_fusion_transformer/sub_modules.py#L71" class="external-link">Implementation PyTorch</a></p></li>
<li><p><a href="https://github.com/PlaytikaResearch/tft-torch/blob/9eee6db42b8ec6b6a586e8852e3af6e2d6b18035/tft_torch/tft.py#L11" class="external-link">Implementation PyTorch</a></p></li>
</ol></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://keras.rstudio.com" class="external-link">keras</a></span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># ================================================================</span></span>
<span class="r-in"><span class="co">#             SEQUENTIAL MODEL, NO GATE VALUES RETURNED</span></span>
<span class="r-in"><span class="co"># ================================================================</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">model</span> <span class="op">&lt;-</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/pkg/keras/man/keras_model_sequential.html" class="external-link">keras_model_sequential</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/keras/man/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu">layer_glu</span><span class="op">(</span><span class="fl">10</span>, input_shape <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loaded Tensorflow version 2.7.0</span>
<span class="r-in"></span>
<span class="r-in"><span class="va">model</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model: "sequential"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ________________________________________________________________________________</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Layer (type)                       Output Shape                    Param #     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ================================================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  glu (GLU)                          (None, 10)                      620         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ================================================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total params: 620</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trainable params: 620</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Non-trainable params: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ________________________________________________________________________________</span>
<span class="r-in"></span>
<span class="r-in"><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu">model</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">32</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 32 10</span>
<span class="r-in"><span class="va">output</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tf.Tensor(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [ 0.6405736   0.23882481 -0.01545329  0.64549947 -0.59216964  0.694118</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.792321   -0.6168756  -0.45180202  0.05729672], shape=(10,), dtype=float32)</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># ================================================================</span></span>
<span class="r-in"><span class="co">#                     WITH GATE VALUES RETURNED</span></span>
<span class="r-in"><span class="co"># ================================================================</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">inp</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/keras/man/layer_input.html" class="external-link">layer_input</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span></span>
<span class="r-in"><span class="va">out</span>  <span class="op">&lt;-</span> <span class="fu">layer_glu</span><span class="op">(</span>units <span class="op">=</span> <span class="fl">10</span>, return_gate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">(</span><span class="va">inp</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/keras/man/keras_model.html" class="external-link">keras_model</a></span><span class="op">(</span><span class="va">inp</span>, <span class="va">out</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">model</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model: "model"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ________________________________________________________________________________</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Layer (type)                       Output Shape                    Param #     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ================================================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  input_1 (InputLayer)               [(None, 30)]                    0           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  glu_1 (GLU)                        [(None, 10),                    620         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                      (None, 10)]                                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ================================================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total params: 620</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trainable params: 620</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Non-trainable params: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ________________________________________________________________________________</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">values</span>, <span class="va">gate</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/keras/man/multi-assign.html" class="external-link">%&lt;-%</a></span> <span class="fu">model</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">32</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 32 10</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">gate</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 32 10</span>
<span class="r-in"></span>
<span class="r-in"><span class="va">values</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tf.Tensor(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [ 1.3827566   1.295771    0.03686381 -0.4063932  -0.4778667  -0.70327306</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -0.06461819 -0.1759624   0.52172124  0.305224  ], shape=(10,), dtype=float32)</span>
<span class="r-in"><span class="va">gate</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tf.Tensor(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [0.7556578  0.68797565 0.27880853 0.44764426 0.8252933  0.44684076</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.1817034  0.8671632  0.74535483 0.589757  ], shape=(10,), dtype=float32)</span>
<span class="r-in"></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://krzjoa.github.io" class="external-link">Krzysztof Joachimiak</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

