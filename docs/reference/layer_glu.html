<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Gated Linear Unit — layer_glu • aion</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Gated Linear Unit — layer_glu"><meta property="og:description" content="In such form introduced in Language modeling with gated convolutional networks
by Dauphin et al., when it was used in sequence processing tasks and compared with
gating mechanism used in LSTM layers. In the context of time series processing explicitly proposed in Temporal Fusion Transformer."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">aion</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Gated Linear Unit</h1>
    
    <div class="hidden name"><code>layer_glu.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>In such form introduced in <a href="https://arxiv.org/abs/1612.08083" class="external-link">Language modeling with gated convolutional networks</a>
by Dauphin et al., when it was used in sequence processing tasks and compared with
gating mechanism used in LSTM layers. In the context of time series processing explicitly proposed in <a href="https://arxiv.org/pdf/1912.09363.pdf" class="external-link">Temporal Fusion Transformer</a>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">layer_glu</span><span class="op">(</span><span class="va">object</span>, <span class="va">units</span>, activation <span class="op">=</span> <span class="cn">NULL</span>, return_gate <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>What to compose the new <code>Layer</code> instance with. Typically a
Sequential model or a Tensor (e.g., as returned by <code><a href="https://rdrr.io/pkg/keras/man/layer_input.html" class="external-link">layer_input()</a></code>).
The return value depends on <code>object</code>. If <code>object</code> is:</p><ul><li><p>missing or <code>NULL</code>, the <code>Layer</code> instance is returned.</p></li>
<li><p>a <code>Sequential</code> model, the model with an additional layer is returned.</p></li>
<li><p>a Tensor, the output tensor from <code>layer_instance(object)</code> is returned.</p></li>
</ul></dd>
<dt>units</dt>
<dd><p>Positive integer, dimensionality of the output space.</p></dd>
<dt>activation</dt>
<dd><p>Name of activation function to use. If you don't specify
anything, no activation is applied (ie. "linear" activation: a(x) = x).</p></dd>
<dt>return_gate</dt>
<dd><p>Logical - return gate values. Default: FALSE</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Tensor of shape batch_size, ..., units. Optionally, it can also return a weights tensor
with identical shape.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Computed according to the equation:
$$GLU(\gamma) = \sigma(W\gamma + b) \odot (V\gamma + c)$$</p>
    </div>
    <div id="references">
    <h2>References</h2>
    
<ol><li><p>Dauphin, Yann N., et al. (2017). <a href="https://arxiv.org/abs/1612.08083" class="external-link">Language modeling with gated convolutional networks.</a>.
International conference on machine learning. PMLR</p></li>
<li><p>Lim, Bryan et al. (2019). <a href="https://arxiv.org/abs/1612.08083" class="external-link">Temporal Fusion Transformers for Interpretable Multi-horizon Time Series Forecasting</a>. arXiv</p></li>
<li><p><a href="https://github.com/jdb78/pytorch-forecasting/blob/268121aa9aa732558beefb6d9f95feff955ad08b/pytorch_forecasting/models/temporal_fusion_transformer/sub_modules.py#L71" class="external-link">Implementation PyTorch</a></p></li>
<li><p><a href="https://github.com/PlaytikaResearch/tft-torch/blob/9eee6db42b8ec6b6a586e8852e3af6e2d6b18035/tft_torch/tft.py#L11" class="external-link">Implementation PyTorch</a></p></li>
</ol></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://keras.rstudio.com" class="external-link">keras</a></span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># ================================================================</span></span>
<span class="r-in"><span class="co">#             SEQUENTIAL MODEL, NO GATE VALUES RETURNED</span></span>
<span class="r-in"><span class="co"># ================================================================</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">model</span> <span class="op">&lt;-</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/pkg/keras/man/keras_model_sequential.html" class="external-link">keras_model_sequential</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/keras/man/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu">layer_glu</span><span class="op">(</span><span class="fl">10</span>, input_shape <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loaded Tensorflow version 2.8.0</span>
<span class="r-in"></span>
<span class="r-in"><span class="va">model</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model: "sequential"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ________________________________________________________________________________</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Layer (type)                       Output Shape                    Param #     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ================================================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  glu (GLU)                          (None, 10)                      620         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ================================================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total params: 620</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trainable params: 620</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Non-trainable params: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ________________________________________________________________________________</span>
<span class="r-in"></span>
<span class="r-in"><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu">model</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">32</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 32 10</span>
<span class="r-in"><span class="va">output</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tf.Tensor(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [-0.36247694 -0.5709695   0.24279653  0.5389923   0.35818368 -0.3389663</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -0.11138822 -0.54544526  0.29529864  0.09058831], shape=(10,), dtype=float32)</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># ================================================================</span></span>
<span class="r-in"><span class="co">#                     WITH GATE VALUES RETURNED</span></span>
<span class="r-in"><span class="co"># ================================================================</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">inp</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/keras/man/layer_input.html" class="external-link">layer_input</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span></span>
<span class="r-in"><span class="va">out</span>  <span class="op">&lt;-</span> <span class="fu">layer_glu</span><span class="op">(</span>units <span class="op">=</span> <span class="fl">10</span>, return_gate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">(</span><span class="va">inp</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/keras/man/keras_model.html" class="external-link">keras_model</a></span><span class="op">(</span><span class="va">inp</span>, <span class="va">out</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">model</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model: "model"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ________________________________________________________________________________</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Layer (type)                       Output Shape                    Param #     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ================================================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  input_1 (InputLayer)               [(None, 30)]                    0           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  glu_1 (GLU)                        [(None, 10),                    620         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                      (None, 10)]                                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ================================================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total params: 620</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trainable params: 620</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Non-trainable params: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ________________________________________________________________________________</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">values</span>, <span class="va">gate</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/keras/man/multi-assign.html" class="external-link">%&lt;-%</a></span> <span class="fu">model</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">32</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 32 10</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">gate</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 32 10</span>
<span class="r-in"></span>
<span class="r-in"><span class="va">values</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tf.Tensor(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [ 0.37070274 -0.50592345 -0.42771906 -0.25968853 -0.35275403  0.10566069</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -0.04980646 -0.27374062 -0.09268104  0.11610245], shape=(10,), dtype=float32)</span>
<span class="r-in"><span class="va">gate</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tf.Tensor(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [0.5550651  0.49924612 0.29802743 0.3920509  0.3225246  0.86447746</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.6200736  0.6329947  0.15607809 0.42023954], shape=(10,), dtype=float32)</span>
<span class="r-in"></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

